<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>野王重生時間計算器</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      background-color: #1e1e2f;
      color: #ffffff;
      font-family: "Microsoft JhengHei", "Segoe UI", Roboto, Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 40px 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    h1 {
      color: #ffcc70;
      margin-top: -15px;
      font-size: 28px;
    }

    label {
      display: block;
      margin: 12px 0 5px;
      font-weight: bold;
      text-align: left;
      width: 100%;
      max-width: 400px;
    }

    .input-group {
      display: flex;
      gap: 10px;
      width: 100%;
      max-width: 400px;
      margin-bottom: 12px;
    }

    input[type="number"], input[type="datetime-local"], select {
      background-color: #2e2e3e;
      color: #ffffff;
      border: 1px solid #555;
      padding: 10px;
      border-radius: 6px;
      width: 100%;
    }

    #bossSelector {
      max-width: 400px;
      margin-bottom: 6px;
    }

    input[type="datetime-local"] {
      max-width: 400px;
      margin-bottom: 6px;
    }

    button {
      margin-top: 10px;
      background: linear-gradient(to right, #ff7e5f, #feb47b);
      color: #1e1e2f;
      padding: 12px 30px;
      font-weight: bold;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    button:hover {
      transform: scale(1.05);
      box-shadow: 0 0 10px #ffb76b;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      max-width: 700px;
      margin-top: 30px;
      background-color: #2a2a40;
      border-radius: 8px;
      overflow: hidden;
    }

    th, td {
      border: 1px solid #444;
      padding: 12px;
      text-align: center;
    }

    th {
      background-color: #3e3e5e;
      color: #ffcc70;
    }

    tr:nth-child(even) {
      background-color: #24243e;
    }

    tr:nth-child(odd) {
      background-color: #2e2e4e;
    }

    .footer {
      margin-top: 5px;
      font-size: 12px;
    }

    .footer a {
      color: #70d6ff;
      text-decoration: none;
    }

    .footer a:hover {
      text-decoration: underline;
    }

    #statusMessage {
      margin-top: 20px;
      font-size: 18px;
      font-weight: bold;
      color: #70ff94;
    }


    .button-row {
  display: flex;
  gap: 12px;
  justify-content: center;
  margin-top: 20px;
}


.button-row button {
  padding: 12px 30px;
  font-weight: bold;
  font-size: 16px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.button-row button:hover {
  transform: scale(1.05);
  box-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
}

  </style>
</head>
<body>
  <div class="container">
    <h1>野王重生時間計算器</h1>

    <label for="repairTime">伺服器開機時間：</label>
    <input type="datetime-local" id="repairTime" />

    <label for="bossSelector">選擇 BOSS ：</label>
    <div class="input-group">
      <select id="bossSelector" onchange="onBossChange()">
        <option value="">-- 請選擇 BOSS --</option>
      </select>
    </div>

    <div id="manualRespawnInputs" style="display: none;">
      <label>重生最短時間：</label>
      <div class="input-group">
        <input type="number" id="minRespawnHour" value="" min="0" placeholder="小時" />
        <input type="number" id="minRespawnMinute" value="" min="0" max="59" placeholder="分鐘" />
      </div>

      <label>重生最長時間：</label>
      <div class="input-group">
        <input type="number" id="maxRespawnHour" value="" min="0" placeholder="小時" />
        <input type="number" id="maxRespawnMinute" value="" min="0" max="59" placeholder="分鐘" />
      </div>
    </div>

    <div class="button-row">
      <button class="calculate-btn" onclick="calculateRespawn()">計算BOSS重生時間</button>
      <button class="check-btn" onclick="checkCurrentRespawningBosses()">查詢當前可能重生的BOSS</button>
    </div>


    <div id="warningMessage" style="margin-top: 10px; max-width: 600px; color: #white; font-weight: bold; font-size: 10px;">
    📍伺服器開機後的前幾次預估時間相對準確，之後可能因加開分流或擊殺時間延遲而有誤差，請以實際重生時間為主。
    </div>
    <div id="statusMessage"></div>

    <table id="resultTable" style="display: none;">
      <thead id="resultHead"></thead>
      <tbody id="resultBody"></tbody>
    </table>


    <div class="footer">
      🔍查詢野王掉落與週期資訊請參考：  
      <a href="https://a2983456456.github.io/artale-drop/" target="_blank">
        https://a2983456456.github.io/artale-drop/
      </a>
      <br>
      🔍 維修開機公告請參考：  
      <a href="https://discord.com/channels/1364050807544090695/1364210991411232828" target="_blank">
        Artale (繁體中文版) Discord 公告
      </a>
    </div>
  </div>

  <script>
    const bossList = [
      {
        name: "😈瘋狂喵z客 (2小時 ~ 7小時)",
        minHour: 2,
        minMinute: 0,
        maxHour: 7,
        maxMinute: 0
      },
      {
        name: "🍢黑輪王",
        minHour: 13,
        minMinute: 0,
        maxHour: 17,
        maxMinute: 0
      },
      {
        name: "🪵仙人娃娃 (2小時38分 ~ 3小時)",
        minHour: 2,
        minMinute: 38,
        maxHour: 3,
        maxMinute: 0
      },
      {
        name: "👹巴洛古 (6小時45分 ~ 9小時)",
        minHour: 6,
        minMinute: 45,
        maxHour: 9,
        maxMinute: 0
      },
      {
        name: "🦊九尾妖狐 (3小時30分 ~ 9小時30分)",
        minHour: 3,
        minMinute: 30,
        maxHour: 9,
        maxMinute: 30
      },
      {
        name: "👻書生幽靈 (2小時30分 ~ 5小時)",
        minHour: 2,
        minMinute: 30,
        maxHour: 5,
        maxMinute: 0
      },
      {
        name: "🍄殭屍蘑菇王 (3小時15分 ~ 3小時45分)",
        minHour: 3,
        minMinute: 15,
        maxHour: 3,
        maxMinute: 45
      },
      {
        name: "🍄蘑菇王 (3小時30分 ~ 4小時)",
        minHour: 3,
        minMinute: 30,
        maxHour: 4,
        maxMinute: 0
      },
      {
        name: "🧙‍♀️雪山魔女 (2小時38分 ~ 3小時)",
        minHour: 2,
        minMinute: 38,
        maxHour: 3,
        maxMinute: 0
      },
      {
        name: "🤖葛雷金剛 (4小時30分 ~ 5小時50分)",
        minHour: 4,
        minMinute: 30,
        maxHour: 5,
        maxMinute: 50
      },
      {
        name: "⛄雪毛怪人 (45分 ~ 1小時8分)",
        minHour: 0,
        minMinute: 45,
        maxHour: 1,
        maxMinute: 8
      },
      {
        name: "💀厄運死神 (45分 ~ 1小時45分)",
        minHour: 0,
        minMinute: 45,
        maxHour: 1,
        maxMinute: 45
      },
      {
        name: "🐱喵怪仙人 (2小時30分 ~ 2小時50分)",
        minHour: 2,
        minMinute: 30,
        maxHour: 2,
        maxMinute: 50
      },
      {
        name: "🐻肯德熊 (1小時53分 ~ 2小時8分)",
        minHour: 1,
        minMinute: 53,
        maxHour: 2,
        maxMinute: 8
      },
      {
        name: "🫚巨大深山人蔘 (1小時 ~ 2小時15分)",
        minHour: 1,
        minMinute: 0,
        maxHour: 2,
        maxMinute: 15
      }
    ];

      let currentRespawnPage = 1;
  let currentBossPage = 1;
  const rowsPerPage = 20;
  let respawnData = [];
  let currentBossData = [];

    function populateBossOptions() {
      const select = document.getElementById('bossSelector');
      bossList.forEach((boss, index) => {
        const option = document.createElement('option');
        option.value = index;
        option.textContent = boss.name;
        select.appendChild(option);
      });
    }

    function onBossChange() {
      const index = document.getElementById('bossSelector').value;
      if (index === "") return;
      const boss = bossList[parseInt(index)];
      document.getElementById('minRespawnHour').value = boss.minHour;
      document.getElementById('minRespawnMinute').value = boss.minMinute;
      document.getElementById('maxRespawnHour').value = boss.maxHour;
      document.getElementById('maxRespawnMinute').value = boss.maxMinute;
    }

    window.addEventListener('DOMContentLoaded', populateBossOptions);

    function calculateRespawn() {
      const repairTimeInput = document.getElementById('repairTime').value;
      const bossSelectorValue = document.getElementById('bossSelector').value;
      const minHours = parseInt(document.getElementById('minRespawnHour').value) || 0;
      const minMinutes = parseInt(document.getElementById('minRespawnMinute').value) || 0;
      const maxHours = parseInt(document.getElementById('maxRespawnHour').value) || 0;
      const maxMinutes = parseInt(document.getElementById('maxRespawnMinute').value) || 0;

      if (!repairTimeInput || !bossSelectorValue) {
        alert("請輸入正確的時間與選擇 BOSS！");
        return;
      }

      const minMs = (minHours * 60 + minMinutes) * 60000;
      const maxMs = (maxHours * 60 + maxMinutes) * 60000;
      const repairTime = new Date(repairTimeInput);
      const resultBody = document.getElementById('resultBody');
      const resultHead = document.getElementById('resultHead');
      const statusMessage = document.getElementById('statusMessage');
      const resultTable = document.getElementById('resultTable');

      // ✅ 清除內容與狀態
      resultBody.innerHTML = "";
      resultHead.innerHTML = "";
      statusMessage.innerHTML = "";

      // ✅ 插入表頭（單 BOSS 模式）
      resultHead.innerHTML = `
        <tr>
          <th>第 N 次</th>
          <th>預計重生開始時間</th>
          <th>預計重生結束時間</th>
        </tr>
      `;

      let baseTime = new Date(repairTime);
      const now = new Date();
      let matchedInterval = null;

      for (let i = 1; i <= 200; i++) {
        const start = new Date(baseTime.getTime() + minMs);
        const end = new Date(baseTime.getTime() + maxMs);

        const row = document.createElement('tr');
        row.innerHTML = `
          <td>第 ${i} 次</td>
          <td>${formatDate(start)}</td>
          <td>${formatDate(end)}</td>
        `;
        resultBody.appendChild(row);

        if (!matchedInterval && now >= start && now <= end) {
          matchedInterval = `⌛ 現在時間落在第 ${i} 次重生區間內！`;
        }

        baseTime = new Date(baseTime.getTime() + maxMs);
      }

      statusMessage.innerText = matchedInterval || "⚠️ 現在時間不在任何預測的重生區間內。";
      resultTable.style.display = 'table';
    }


    function checkCurrentRespawningBosses() {
      const repairTimeInput = document.getElementById('repairTime').value;
      if (!repairTimeInput) {
        alert("請先輸入伺服器開機時間！");
        return;
      }

      const repairTime = new Date(repairTimeInput);
      const now = new Date();

      const resultBody = document.getElementById('resultBody');
      const resultHead = document.getElementById('resultHead');
      const statusMessage = document.getElementById('statusMessage');
      const resultTable = document.getElementById('resultTable');

      // ✅ 清除先前內容
      resultBody.innerHTML = "";
      resultHead.innerHTML = "";
      statusMessage.innerHTML = "";

      // ✅ 插入表頭（多 BOSS 模式）
      resultHead.innerHTML = `
        <tr>
          <th>BOSS 名稱</th>
          <th>第 N 次</th>
          <th>預計重生開始時間</th>
          <th>預計重生結束時間</th>
        </tr>
      `;

      let hasMatch = false;

      bossList.forEach(boss => {
        const minMs = (boss.minHour * 60 + boss.minMinute) * 60000;
        const maxMs = (boss.maxHour * 60 + boss.maxMinute) * 60000;

        let baseTime = new Date(repairTime);

        for (let i = 1; i <= 200; i++) {
          const start = new Date(baseTime.getTime() + minMs);
          const end = new Date(baseTime.getTime() + maxMs);

          if (now >= start && now <= end) {
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${boss.name}</td>
              <td>第 ${i} 次</td>
              <td>${formatDate(start)}</td>
              <td>${formatDate(end)}</td>
            `;
            resultBody.appendChild(row);
            hasMatch = true;
            break;
          }

          baseTime = new Date(baseTime.getTime() + maxMs);
        }
      });

      if (!hasMatch) {
        const row = document.createElement('tr');
        row.innerHTML = `<td colspan="4">目前時間不在任何 BOSS 的重生區間內。</td>`;
        resultBody.appendChild(row);
      }

      resultTable.style.display = 'table';
    }




    function formatDate(date) {
      const y = date.getFullYear();
      const m = String(date.getMonth() + 1).padStart(2, '0');
      const d = String(date.getDate()).padStart(2, '0');
      const h = String(date.getHours()).padStart(2, '0');
      const min = String(date.getMinutes()).padStart(2, '0');
      return `${y}/${m}/${d} ${h}:${min}`;
    }

  </script>
</body>
</html>
